PARAMETERS dStart DateTime, dEnd DateTime;
SELECT GFP_DM_DP_SUBMIT_VAR.DEV_CD AS DevCode, GFP_DM_DP_SUBMIT_VAR.STYLE AS Style, GFP_DM_DP_SUBMIT_VAR.CLR AS Color, GFP_DM_DP_SUBMIT_VAR.SY_STY_NM AS Model_Name, GFP_DM_DP_SUBMIT_VAR.XPL_PROD_LN_CD AS Prod_Line, GFP_DM_DP_SUBMIT_VAR.XPL_PROD_LN_DESC AS Prod_Desc, GFP_DM_DP_SUBMIT_VAR.XPC_PROD_CAT_CD AS Cat_Line, GFP_DM_DP_SUBMIT_VAR.XPC_PROD_CAT_DESC AS Cat_Desc, GFP_DM_DP_SUBMIT_VAR.XPR_PROD_TYP_CD AS Type_CD, GFP_DM_DP_SUBMIT_VAR.XPR_PROD_TYP_DESC AS Type_Desc, GFP_DM_DP_SUBMIT_VAR.SY_STY_GRP_NBR AS Style_Group, Sum(GFP_DM_DP_SUBMIT_VAR.NNDP_PREV_QTY) AS Demand, 0 AS Curr_Qty, Sum(GFP_DM_DP_SUBMIT_VAR.NNDP_PREV_QTY) AS Prev_Qty, "Prev_DM_" & Format([Buy_Month],"mmm_yyyy") AS MonthN
FROM GFP_DM_DP_SUBMIT_VAR
WHERE (((CDate(Month([Buy_Month]) & "/" & Year([Buy_Month]))) Between [dStart] And [dEnd]) AND ((GFP_DM_DP_SUBMIT_VAR.DEMAND_COUNTRY)<>[sUSA] And (GFP_DM_DP_SUBMIT_VAR.DEMAND_COUNTRY)<>[sNETH]))
GROUP BY GFP_DM_DP_SUBMIT_VAR.DEV_CD, GFP_DM_DP_SUBMIT_VAR.STYLE, GFP_DM_DP_SUBMIT_VAR.CLR, GFP_DM_DP_SUBMIT_VAR.SY_STY_NM, GFP_DM_DP_SUBMIT_VAR.XPL_PROD_LN_CD, GFP_DM_DP_SUBMIT_VAR.XPL_PROD_LN_DESC, GFP_DM_DP_SUBMIT_VAR.XPC_PROD_CAT_CD, GFP_DM_DP_SUBMIT_VAR.XPC_PROD_CAT_DESC, GFP_DM_DP_SUBMIT_VAR.XPR_PROD_TYP_CD, GFP_DM_DP_SUBMIT_VAR.XPR_PROD_TYP_DESC, GFP_DM_DP_SUBMIT_VAR.SY_STY_GRP_NBR, 0, GFP_DM_DP_SUBMIT_VAR.BUY_MONTH
ORDER BY GFP_DM_DP_SUBMIT_VAR.DEV_CD, GFP_DM_DP_SUBMIT_VAR.STYLE, GFP_DM_DP_SUBMIT_VAR.CLR;
